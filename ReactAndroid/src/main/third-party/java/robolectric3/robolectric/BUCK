load("//ReactNative:DEFS.bzl", "react_native_dep", "rn_android_library", "rn_prebuilt_jar")

rn_android_library(
    name = "robolectric",
    visibility = ["//ReactAndroid/..."],
    exported_deps = [
        ":android-all-4.1.2_r1-robolectric-r1",
        ":bouncycastle",
        ":robolectric-annotations",
        ":robolectric-core",
        ":robolectric-junit",
        ":robolectric-resources",
        ":robolectric-sandbox",
        ":robolectric-shadowapi",
        ":robolectric-shadows-framework",
        ":robolectric-utils",
        ":guava",
        ":xstream",
        react_native_dep("third-party/java/asm:asm"),
        react_native_dep("third-party/java/sqlite:sqlite"),
    ],
)

rn_prebuilt_jar(
    name = "robolectric-core",
    binary_jar = ":robolectric-binary.jar",
    visibility = ["//ReactAndroid/..."],
)

remote_file(
    name = "robolectric-binary.jar",
    sha1 = "26cfb22e682110716ccd516da2f2851016b3efae",
    url = "mvn:org.robolectric:robolectric:jar:3.6.1",
)

rn_prebuilt_jar(
    name = "robolectric-resources",
    binary_jar = ":robolectric-resources-binary.jar",
    visibility = ["//ReactAndroid/..."],
)

remote_file(
    name = "robolectric-resources-binary.jar",
    sha1 = "f8b6cf44b7729839ce3e1778424d97d47b55d305",
    url = "mvn:org.robolectric:resources:jar:3.6.1",
)

rn_prebuilt_jar(
    name = "robolectric-annotations",
    binary_jar = ":robolectric-annotations-binary.jar",
    visibility = ["//ReactAndroid/..."],
)

remote_file(
    name = "robolectric-annotations-binary.jar",
    sha1 = "bc643af7206d2de1ab8902c80baf620ffd5ad302",
    url = "mvn:org.robolectric:annotations:jar:3.6.1",
)

rn_prebuilt_jar(
    name = "robolectric-junit",
    binary_jar = ":robolectric-junit-binary.jar",
    visibility = ["//ReactAndroid/..."],
)

remote_file(
    name = "robolectric-junit-binary.jar",
    sha1 = "a2e92127ed9596fb9406d1b49dc9daf091d5fa43",
    url = "mvn:org.robolectric:junit:jar:3.6.1",
)

rn_prebuilt_jar(
    name = "robolectric-sandbox",
    binary_jar = ":robolectric-sandbox-binary.jar",
    visibility = ["//ReactAndroid/..."],
)

remote_file(
    name = "robolectric-sandbox-binary.jar",
    sha1 = "7b700eb7938ac3857c70013403e478b44e1d27c3",
    url = "mvn:org.robolectric:sandbox:jar:3.6.1",
)

rn_prebuilt_jar(
    name = "robolectric-shadows-framework",
    binary_jar = ":robolectric-shadows-framework-binary.jar",
    visibility = ["//ReactAndroid/..."],
)

remote_file(
    name = "robolectric-shadows-framework-binary.jar",
    sha1 = "157acb72761a31a8eaa2e41d9d9b57d81a232c8b",
    url = "mvn:org.robolectric:shadows-framework:jar:3.6.1",
)

rn_prebuilt_jar(
    name = "robolectric-utils",
    binary_jar = ":robolectric-utils-binary.jar",
    visibility = ["//ReactAndroid/..."],
)

remote_file(
    name = "robolectric-utils-binary.jar",
    sha1 = "a561992a644530a5a39eda744288bdb05c796141",
    url = "mvn:org.robolectric:utils:jar:3.6.1",
)

rn_prebuilt_jar(
    name = "bouncycastle",
    binary_jar = ":bouncycastle-binary.jar",
    visibility = ["//ReactAndroid/..."],
)

remote_file(
    name = "bouncycastle-binary.jar",
    sha1 = "88a941faf9819d371e3174b5ed56a3f3f7d73269",
    url = "mvn:org.bouncycastle:bcprov-jdk15on:jar:1.52",
)

rn_prebuilt_jar(
    name = "guava",
    binary_jar = ":guava-binary.jar",
    visibility = ["//ReactAndroid/..."],
)

remote_file(
    name = "guava-binary.jar",
    sha1 = "89507701249388e1ed5ddcf8c41f4ce1be7831ef",
    url = "mvn:com.google.guava:guava:jar:20.0",
)

rn_prebuilt_jar(
    name = "xstream",
    binary_jar = ":xstream-binary.jar",
    visibility = ["//ReactAndroid/..."],
)

remote_file(
    name = "xstream-binary.jar",
    sha1 = "520d90f30f36a0d6ba2dc929d980831631ad6a92",
    url = "mvn:com.thoughtworks.xstream:xstream:jar:1.4.8",
)

rn_prebuilt_jar(
    name = "android-all-4.1.2_r1-robolectric-r1",  # name defines filename used by robolectric in runtime
    binary_jar = ":robolectric-android-all-binary.jar",
    visibility = ["//ReactAndroid/..."],
)

# This new rule will make the .jar file appear in the "right" location,
# though that may change in the future
export_file(
    name = "robolectric-android-all-binary.jar",
    src = ":robolectric-android-all-binary-remote.jar",
    out = "../android-all-4.1.2_r1-robolectric-r1.jar",  # name defines filename used by robolectric in runtime
)

remote_file(
    name = "robolectric-android-all-binary-remote.jar",
    sha1 = "8355a2da59fe0233ca45070ca32f08da98d0b806",
    url = "mvn:org.robolectric:android-all:jar:4.1.2_r1-robolectric-r1",
)

rn_prebuilt_jar(
    name = "robolectric-shadowapi",  # name defines filename used by robolectric in runtime
    binary_jar = ":robolectric-shadows.jar",
    visibility = ["//ReactAndroid/..."],
)

remote_file(
    name = "robolectric-shadows.jar",
    sha1 = "a1fcdb89cf593aa01fde2ad35f4f85cc2a9c1e15",
    url = "mvn:org.robolectric:shadowapi:jar:3.6.1",
)
